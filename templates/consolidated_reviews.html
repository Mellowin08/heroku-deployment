<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap & CSS-->
    <link rel="stylesheet" href="../static/css/styles.css">
    <link rel="stylesheet" href="../static/css/consolidated_reviews.css">
    <link rel="stylesheet" href="../static/css/modal.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../static/images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../static/images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../static/images/favicons/favicon-16x16.png">
    <link rel="manifest" href="../static/images/favicons//site.webmanifest">
    <!-- Other Scripts -->
    <script src="../static/js/footer.js" type="text/javascript" defer></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <title>RevU's | Consolidated Analyzer</title>
</head>
<body>
    <!-- Disclaimer Modal -->
    <div id="consolidated_disclaimer" class="modal">
        <div class="modal-content p-md-5 modal-scrollable">
            <center>
            <h2>Disclaimer</h2>
                <p>Our Consolidated Product Review Analyzer employs a machine learning model to process and analyze reviews from various sources. It is essential to acknowledge that, like any sophisticated system, the consolidated analyzer has its limitations. One noticeable aspect is the occasional inconsistency in grammatical structure within the phrases generated by the system, which may result in sentences that don't always read fluently.</p>
                <p>It is imperative to recognize that these limitations are intrinsic to our current priorities. The primary focus of our endeavors remains the development and refinement of the underlying machine learning model. Consequently, while the consolidated analyzer functionality is a valuable addition, it occupies a tertiary position in our hierarchy of objectives.</p> 
            <button id="consolidated_understandButton" class="blue-button">I Understand</button>
            </center>
        </div>
    </div>
    <nav class="pl-5 pr-5 navbar navbar-expand-lg align-items-center navbar-dark fixed-top">
        <a class="navbar-brand" href="index.html">RevUâ€™s</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <a class="nav-link" href="index.html#home">Home</a>
                <a class="nav-link" href="index.html#features">Features</a>
                <a class="nav-link" href="index.html#context">Context</a>
                <a class="nav-link" href="index.html#team">The Team</a>
                <li class="nav-item dropdown">
                    <a id="caret" class="nav-link dropdown-toggle active" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Analyzer
                    </a>
                    <div class="dropdown-menu dropdown-menu-right fade-in" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="individual_review.html">Individual Review</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item active" href="consolidated_reviews.html">Consolidated Reviews</a>
                    </div>
                </li>
            </ul>
        </div>
    </nav>
    <div class="container d-flex flex-column row align-items-center p-5 mx-auto mt-5">
        <h2 class="text-center p-2" style="color: #A3C6EE">Consolidated Product Review Analyzer</h2>
        <form id="upload-form" action="/consolidate_csv" method="post" enctype="multipart/form-data">
            <label for="upload-input" class="upload-label">
                    <div id="upload-container" class="d-flex flex-column align-items-center justify-content-center">
                        <div id="pre-upload">
                            <img src="../static/images/csv_upload-icon.png" width="100" class="m-3">
                            <p style="font-weight: bold">Choose a CSV file <br> <span style="font-weight: normal;">or</span> <br> Drop it here <br> </p> 
                            <p style="font-style: italic; font-size: 10px;">Note: For CSV uploads, format your file with one column titled "Reviews." <br>Each review should be listed below this title.</p>
                        </div>
                        <input type="file" name="file" id="upload-input" accept=".csv" class="d-none">
                        <div id="uploaded-csv" style="display: none;">
                            <img src="../static/images/Sentivm-Product.png" width="100" class="m-3">
                            <p>Selected CSV File:</p>
                            <div id="file-name-box"></div>
                            <button type="button" id="reset-button" class="btn btn-secondary m-3">Reset</button>
                        </div>
                    </div>
            </label>
            
            <div class="text-center"><button id="analyze-button" type="submit" class="btn btn-secondary m-3" id="predictButton" disabled>Analyze</button></div>
            
        </form>
    </div>
    <footer-component></footer-component>
<!-- Include Bootstrap JS and Popper.js -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="../static/js/disclaimer_modal.js" type="text/javascript"></script>
    <script>
        manageModalDisplay("consolidated_disclaimer", "consolidated_understandButton", "consolidated_disclaimerAgreed")
// Initialize Bootstrap dropdowns
    $(document).ready(function () {
        $('.dropdown-toggle').dropdown();
    });
    const uploadInput = document.getElementById('upload-input');
    const preUpload = document.getElementById('pre-upload');
    const uploadedCSV = document.getElementById('uploaded-csv');
    const fileNameBox = document.getElementById('file-name-box');
    const uploadContainer = document.getElementById('upload-container');
    const analyzeButton = document.getElementById('analyze-button');
    function updateUI(selectedFile) {
        if (selectedFile) {
            fileNameBox.textContent = selectedFile.name;
            preUpload.style.display = 'none';
            uploadedCSV.style.display = 'block';
            uploadContainer.style.border = '4px solid blue';
            analyzeButton.disabled = false; 
            analyzeButton.classList.remove('btn-secondary'); 
            analyzeButton.classList.add('btn-primary');

        } else {
            uploadInput.value = ''; // Clear the file input
            fileNameBox.textContent = '';
            preUpload.style.display = 'block';
            uploadedCSV.style.display = 'none';
            uploadContainer.style.border = '4px dashed #cccccc';
            analyzeButton.disabled = true; 
            analyzeButton.classList.remove('btn-primary'); 
            analyzeButton.classList.add('btn-secondary'); 
        }
    }
// Handle file input change
    uploadInput.addEventListener('change', function () {
        const selectedFile = this.files[0];
        updateUI(selectedFile);
    });
// Handle reset button click
    document.getElementById('reset-button').addEventListener('click', function () {
        updateUI(null);
    });

// Handle file drop events
    uploadContainer.addEventListener('dragover', function (e) {
        e.preventDefault();
        uploadContainer.style.border = '4px solid blue';
    });
    uploadContainer.addEventListener('dragleave', function (e) {
        e.preventDefault();
        uploadContainer.style.border = '4px dashed #cccccc';
    });
    uploadContainer.addEventListener('drop', function (e) {
        e.preventDefault();
        const droppedFile = e.dataTransfer.files[0];
        uploadInput.files = e.dataTransfer.files;
        updateUI(droppedFile);
    });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var uploadContainer = document.getElementById("upload-container");
            var preUploadDiv = document.getElementById("pre-upload");
            var uploadedCsvDiv = document.getElementById("uploaded-csv");
    
            uploadContainer.addEventListener("dragover", function (e) {
                e.preventDefault();
                e.stopPropagation();
                uploadContainer.classList.add("dragover");
            });
    
            uploadContainer.addEventListener("dragleave", function (e) {
                e.preventDefault();
                e.stopPropagation();
                uploadContainer.classList.remove("dragover");
            });
    
            uploadContainer.addEventListener("drop", function (e) {
                e.preventDefault();
                e.stopPropagation();
                uploadContainer.classList.remove("dragover");
    
                var files = e.dataTransfer.files;
                if (files.length > 0) {
                    var file = files[0];
                    if (file.type === "application/vnd.ms-excel" || file.name.endsWith(".csv")) {
                        // Valid CSV file dropped, show uploaded-csv div
                        uploadedCsvDiv.style.display = "block";
                        document.getElementById("file-name-box").innerText = file.name;
                        document.getElementById("analyze-button").disabled = false;
    
                        // Hide pre-upload div
                        preUploadDiv.style.display = "none";
                    } else {
                        // Invalid file type dropped, hide uploaded-csv div and show pre-upload div
                        uploadedCsvDiv.style.display = "none";
                        uploadContainer.style.border = '4px dashed #cccccc';
                        preUploadDiv.style.display = "block";
                        alert("Please upload a valid CSV file.");
                    }
                }
            });
        });
    </script>
</body>
</html>
